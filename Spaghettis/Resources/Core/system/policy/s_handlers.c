
/* Copyright (c) 1997-2020 Miller Puckette and others. */

/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

#include "../../m_spaghettis.h"
#include "../../m_core.h"

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

#ifndef SIGIOT
#define SIGIOT SIGABRT
#endif

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

PD_LOCAL void main_exit (void);

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

static void handlers_exit (int n)
{
    main_exit();
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

PD_LOCAL void sys_setSignalHandlers (void)
{
    // signal (SIGTERM, handlers_exit);
    signal (SIGINT,  handlers_exit);
    signal (SIGQUIT, handlers_exit);
    signal (SIGILL,  handlers_exit);
    signal (SIGIOT,  handlers_exit);
    signal (SIGFPE,  SIG_IGN);
    signal (SIGPIPE, SIG_IGN);
    signal (SIGALRM, SIG_IGN);
    signal (SIGHUP,  SIG_IGN);
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
