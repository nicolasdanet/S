#! /usr/bin/env bash

# ------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------

# Must be executed at the same level.

rep=$(pwd); [ "${0%/*}" = "." ] || exit 1

# ------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------

# Locate FreeType (Debian, Homebrew, MacPorts).

if [ -d "/usr/include/freetype2" ]; then
    freetype="-I/usr/include/freetype2 -lfreetype"
elif [ -d "/usr/local/include/freetype2" ]; then
    freetype="-I/usr/local/include/freetype2 -L/usr/local/lib/ -lfreetype"
elif [ -d "/opt/local/include/freetype2" ]; then 
    freetype="-I/opt/local/include/freetype2 -L/opt/local/lib/ -lfreetype"
fi

# ------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------

[ -n "${freetype}" ] || { echo >&2 "${0##*/}: Cannot find FreeType"; exit 1; }

# ------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------

# Create folder.

target="${rep}/Builds/Tools"

# ------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------

if ! [ -e "${target}" ]; then
    mkdir -p "${target}" 
fi

# ------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------

[ -d "${target}" ]  || exit 1;

# ------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------

# Files.

tools=("Bellefont.cpp" "Gentium.cpp" "Joie.cpp" "Petrucci.cpp")

# ------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------

# Warnings.

warnings=("-Wall" "-Wextra" "-Wshadow")

# ------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------

# Build.

for file in "${tools[@]}"; do

    name="${file%.*}"
    path="${rep}/${file}"
    dest="${target}/${name}"
    echo "Build ${name} ..."
    g++  "-std=c++11" "${path}" -o "${dest}" "${warnings[@]}" ${freetype} || exit 1
    
done

# ------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------
