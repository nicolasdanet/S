
/* Copyright (c) 2023 Jojo and others. */

/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

namespace spaghettis {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

ContextMenu::ContextMenu (EditView* view) : view_ (view)
{

}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

namespace {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

juce::PopupMenu::Options getContextMenuOptions (ObjectComponent* c)
{
    return juce::PopupMenu::Options().withDeletionCheck (*c);
}

juce::PopupMenu getContextMenu()
{
    juce::PopupMenu m;
    
    m.addItem (1, "item 1");
    m.addItem (2, "item 2");
    
    return m;
}

auto contextMenuHandler (EditView* view)
{
    return [p = juce::Component::SafePointer<EditView> (view)] (int result)
        {
            if (p.getComponent()) { DBG ("!!!"); }
        };
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

void ContextMenu::open (const juce::MouseEvent&, ObjectComponent* c)
{
    juce::PopupMenu m (getContextMenu());
    
    m.showMenuAsync (getContextMenuOptions (c), contextMenuHandler (view_));
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
