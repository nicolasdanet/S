
/* Copyright (c) 2023 Jojo and others. */

/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

namespace spaghettis {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

ActionConnect::ActionConnect (EditView* view) : view_ (view)
{
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

void ActionConnect::createComponent (const juce::Point<int>& pt)
{
    connectComponent_ = std::make_unique<ActionConnectComponent> (pt);
    
    view_->addAndMakeVisible (connectComponent_.get());
}

void ActionConnect::updateComponent (const juce::Point<int>& pt)
{
    tracker_.hit (view_, pt);
    
    if (connectComponent_) { connectComponent_->set (pt); }
    else {
        createComponent (pt);
    }
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

void ActionConnect::mouseDrag (const juce::MouseEvent& e)
{
    updateComponent (e.getPosition());
}

void ActionConnect::mouseUp (const juce::MouseEvent& e)
{
    if (connectComponent_) {
        view_->removeChildComponent (connectComponent_.get());
        connectComponent_ = nullptr;
    }
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
