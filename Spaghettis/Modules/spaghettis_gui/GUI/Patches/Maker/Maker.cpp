
/* Copyright (c) 2023 Jojo and others. */

/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

namespace spaghettis {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

Maker::Maker (EditView* owner) : owner_ (owner), tracker_ (owner), v_()
{
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

void Maker::showEditor (const std::optional<juce::Point<int>>& a, const std::optional<juce::Point<int>>& b)
{
    if (a.has_value() && b.has_value()) {
    //
    pt_ = b.value();
    
    auto t = std::make_unique<MakerComponent> (owner_, v_, pt_);
    auto r = juce::Rectangle<int> (4, 4).withCentre (a.value());
    
    tracker_.track (juce::CallOutBox::launchAsynchronously (std::move (t), r, nullptr));
    //
    }
}

void Maker::hideEditor()
{
    tracker_.dismiss();
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

void Maker::reset (juce::Value& v)
{
    v.setValue (juce::String());
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
