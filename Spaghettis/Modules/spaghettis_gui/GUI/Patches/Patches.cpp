
/* Copyright (c) 2021 Nicolas Danet. */

/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

namespace spaghettis {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

Patch* Patches::fetchPatch (const core::Unique& u) const
{
    auto f = [i = u.getRoot()] (const RootsElement& e)
    {
        return (std::get<0> (e) == i);
    };
        
    auto r = std::find_if (roots_.cbegin(), roots_.cend(), f);
    
    return r != roots_.cend() ? std::get<1> (*r).get() : nullptr;
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

void Patches::createPatch (const core::Unique& u, const core::Description& v)
{
    roots_.emplace_back (u.getRoot(), std::make_unique<Patch> (u, v));
}

void Patches::fetchAndAddObject (const core::Unique& u, const core::Description& v)
{
    Patch* p = fetchPatch (u);
    
    if (p) { DBG (v.debug()); DBG (u.debug()); }
    else {
        jassertfalse;
    }
}

void Patches::fetchAndRemoveObject (const core::Unique& u)
{
    /*
    Patch* p = fetchPatch (u);
    
    if (p) { }
    */
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

} // namespace spaghettis

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
