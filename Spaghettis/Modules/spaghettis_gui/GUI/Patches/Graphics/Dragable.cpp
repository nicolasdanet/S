
/* Copyright (c) 2023 Jojo and others. */

/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

namespace spaghettis {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

Dragable::Dragable (View* view) : view_ (view), isForwarding_ (false), isDraggingView_ (false)
{
}

Dragable::~Dragable()
{
    if (isDraggingView_) {
        if (auto view = getEditView()) {
            view->handleMouseDragAbort();
        }
    }
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

EditView* Dragable::getEditView() const
{
    return View::asEditView (getView());
}
    
// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

bool Dragable::forwardMouseDown (const juce::MouseEvent& e)
{
    return Mouse::isCommandClick (e);
}

bool Dragable::forwardMouseDrag (const juce::MouseEvent& e, DragFlag flag)
{
    isDraggingView_ = true;
    
    if (auto view = getEditView()) { view->handleMouseDrag (e, flag); }
    
    return false;
}

bool Dragable::forwardMouseUp (const juce::MouseEvent& e)
{
    isDraggingView_ = false;
    
    if (auto view = getEditView()) { view->handleMouseUp (e); }
    
    return false;
}
    
// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
