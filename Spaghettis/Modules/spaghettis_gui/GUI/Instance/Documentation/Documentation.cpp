
/* Copyright (c) 2022 Spaghettis and others. */

/* < https://www.gnu.org/licenses/agpl-3.0.en.html > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

namespace spaghettis {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

namespace {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

auto findResource (const juce::String& c)
{
    const juce::String name  = c + juce::String ("_pdinfo");
    int n = 0; const char* p = BinaryData::getNamedResource (name.toRawUTF8(), n);
    
    return std::tuple<int, const char*> (n, p);
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

void addDocumentation (data::Data& data, const juce::String& c)
{
    if (c.isNotEmpty()) {
    //
    auto [n, p] = findResource (c);
    
    if (n && p) {
    //
    // data.setValuesFromDocumentation (juce::String::createStringFromData (p, n));
    //
    }
    //
    }
}

/*
data::Data Documentation::get (const juce::String& c)
{
    data::Data data (Id::DOCUMENTATION);
    
    addDocumentation (data, c);
    
    return data;
}
*/

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

std::optional<data::Data> Documentation::get (const juce::String& c)
{
    return std::nullopt;
}

std::optional<data::Data> Documentation::get (const core::Item& i)
{
    if (i.hasParameter (Tag::Attributes, Tag::Class)) {
        return get (i.get<juce::String> (Tag::Attributes, Tag::Class));
    }
    
    return std::nullopt;
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

data::Data Documentation::makeCopyWithDocumentation (const core::Item& item)
{
    data::Data data (data::Data::makeCopy (item.getData()));
    
    return data;
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
