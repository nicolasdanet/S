
/* Copyright (c) 2021 Jojo and others. */

/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

namespace spaghettis::core {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

struct _object;

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

class Report {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

private:
    explicit Report (const juce::ValueTree& t) : tree_ (t)
    {
    }

public:
    ~Report() = default;

public:
    Report (const Report&) = default;
    Report (Report&&) = default;
    Report& operator = (const Report&) = default;
    Report& operator = (Report&&) = default;

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

public:
    juce::ValueTree asValueTree() const
    {
        return tree_;
    }

    juce::String debug() const;
    
// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

public:
    bool isObject() const
    {
        return isObject (tree_);
    }
    
    bool isLine() const
    {
        return isLine (tree_);
    }

    bool isPatch() const
    {
        return isPatch (tree_);
    }
    
// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

/* An object can be a patch. */
/* A patch is a kind of object. */

public:
    static bool isObject (const juce::ValueTree& tree)
    {
        return (tree.getType() == Ids::OBJECT || tree.getType() == Ids::PATCH);
    }
    
    static bool isLine (const juce::ValueTree& tree)
    {
        return (tree.getType() == Ids::LINE);
    }

    static bool isPatch (const juce::ValueTree& tree)
    {
        return (tree.getType() == Ids::PATCH);
    }
    
// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

public:
    static Report object (const UniquePath&, struct _object*);
    static Report objectAttributes (const UniquePath&, struct _object*);
    static Report objectParameters (const UniquePath&, struct _object*);
    static Report line (const UniquePath&, struct _object*, int, struct _object*, int);
    
private:
    juce::ValueTree tree_;
    
private:
    JUCE_LEAK_DETECTOR (Report)
};

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
