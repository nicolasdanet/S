
/* Copyright (c) 2022 Jojo and others. */

/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

namespace spaghettis::core {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

/* Negative coordinates are not well supported by the JUCE framework. */
/* Hence the canvas size is arbitrary limited. */
/* Then an offset is added to objects positions. */
/* That way the origin is put at the middle. */
/* It should not remain negative values. */
/* That offset is removed later to keep compatiblity with legacy format. */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

struct Canvas {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

static constexpr int getSize()
{
    return (2 << 24);           /* Arbitrary. */
}

static constexpr int getOffset()
{
    return getSize() >> 8;      /* Much smaller to allow zooming. */
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

static int addOffset (int n)
{
    return n + getOffset();
}

static int removeOffset (int n)
{
    return n - getOffset();
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

/* Get bounds with compensated offset. */

static juce::Rectangle<int> getArea (float scale)
{
    const int n = static_cast<int> (getOffset() * scale);
    const int s = getSize();
    
    return juce::Rectangle<int> (-n, -n, s, s);
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

};

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
