
/* Copyright (c) 2022 Jojo and others. */

/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

namespace spaghettis {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

namespace core {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

struct Parameter {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

static bool isValid (const juce::ValueTree& parameter)
{
    return (parameter.hasType (Ids::PARAMETER)
                && parameter.getProperty (Ids::item).isString()
                && parameter.getProperty (Ids::text).isString()
                && parameter.getProperty (Ids::info).isString()
                && parameter.getProperty (Ids::type).isString()
                && parameter.hasProperty (Ids::value));
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

};

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

struct Group {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

static bool isValid (const juce::ValueTree& group)
{
    return (group.hasType (Ids::GROUP) && group.getProperty (Ids::name).isString());
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

};

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

struct Tree {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

static const juce::var getValueForItem (const juce::ValueTree& tree, const juce::String& item)
{
    for (const auto& group : tree) {
    for (const auto& parameter : group) {
        if (parameter.getProperty (Ids::item).equalsWithSameType (item)) {
            return parameter.getProperty (Ids::value);
        }
    }
    }
    
    jassertfalse;
    
    return juce::var();
}

static bool isValid (const juce::ValueTree& tree, const juce::Identifier& identifier)
{
    if (tree.isValid() && tree.hasType (identifier)) {
    //
    for (const auto& group : tree) {
    //
    if (Group::isValid (group)) {
        for (const auto& parameter : group)  {
            if (!Parameter::isValid (parameter)) { return false; }
        }
    } else { return false; }
    //
    }
    //
    } else { return false; }
    
    return true;
}

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

};

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

} // namespace core

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

} // namespace spaghettis

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
