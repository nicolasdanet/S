
/* Copyright (c) 2021 Nicolas Danet. */

/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

namespace spaghettis {

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

void Wrapper::run()
{
    bool error = false;
    
    try {
        error = core::main_threadLoop (this);
    }
    catch (...) {
        error = true;
    }

    if (error) {
    //
    juce::String s = juce::String (PD_NAME_LOWERCASE) + juce::String (": core error");
    
    post (NEEDS_TRANS (s), Logger::Type::error);
    //
    }
}

juce::StringArray Wrapper::getCommandLine() const
{
    juce::StringArray t (commandLine_);
    
    t.removeString ("-NSDocumentRevisionsDebugMode");
    t.removeString ("YES");
    t.insert (0, PD_NAME);
    
    return t;
}
    
// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

} // namespace spaghettis

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
