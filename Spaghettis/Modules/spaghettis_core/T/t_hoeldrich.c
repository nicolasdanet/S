
/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

/* Testing Hoeldrich trick. */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

#define TEST_HOELDRICH_LOOP     1000000

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

#if 0
void test63__base() {
#endif

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

TTT_BEGIN (HoeldrichBase, 63, "Hoeldrich - Base")

    int i;
    
    cos_tilde_initialize();
    
    t_rand48 seed; PD_RAND48_INIT (seed);
    
    for (i = 0; i < TEST_HOELDRICH_LOOP; i++) {
    //
    double t = (PD_RAND48_DOUBLE (seed) - 0.5) * 4096;
    double f = dsp_getCosineAtLUT (t * COSINE_TABLE_SIZE);
    double g = cos (t * PD_TWO_PI);
    
    int k = math_areEquivalent (f, g, 1E-4);

    if (t > -1024.0 && t < 1024.0) { TTT_EXPECT (k); }      /* TOTALLY wrong outside that range. */
    //
    }
    
    double f0 =  1024.0;    // --
    double f1 = -1024.0;

    TTT_EXPECT (math_areEquivalent (dsp_getCosineAtLUT (f0 * COSINE_TABLE_SIZE), cos (f0 * PD_TWO_PI), 1E-4));
    TTT_EXPECT (math_areEquivalent (dsp_getCosineAtLUT (f1 * COSINE_TABLE_SIZE), cos (f1 * PD_TWO_PI), 1E-4));
    
    cos_tilde_release();

TTT_END

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

#if 0
}
#endif

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
